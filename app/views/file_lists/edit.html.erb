<h1>File Listing</h1>

<% if @work_version.file_resources.present? %>
  <table class="table table-striped">
    <thead>
      <tr><th>Name</th><th>Size</th><th>Mime Type</th><th>Actions</th></tr>
    </thead>
    <tbody>
      <%# TODO move to controller? %>
      <% file_memberships =  @work_version.file_version_memberships.includes(:file_resource) %>
      <% file_memberships.each do |membership| %>
        <% resource = membership.file_resource %>
        <tr id="<%= dom_id membership %>">
          <td><%= membership.title %></td>
          <td><%= number_to_human_size resource.file.size %></td>
          <td><%= resource.file.mime_type %></td>
          <td>
            <%= link_to 'Rename', edit_work_version_file_path(params[:work_id], params[:version_id], membership.id) %> |
            <%= link_to 'Delete',
                work_version_file_path(params[:work_id], params[:version_id], membership.id),
                method: :delete, data: { confirm: 'Are you sure?' } %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<%= render 'form', version: @work_version %>

<%= link_to 'Back', work_version_path(params[:work_id], params[:version_id]) %>
